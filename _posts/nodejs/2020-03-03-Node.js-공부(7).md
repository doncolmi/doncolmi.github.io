---
layout: post
title: Node.js(7) - npm과 nodemon
date: 2020-03-03 10:36:00 +0000
description: hello
img: nodejs.jpg
tags: [nodejs]
---

# npm

---

<center><img src="/assets/img/nodejs/2020-03-03-Node.js-공부(7)/1.png"></center>

npm은 Node.js에서 사용 가능한 모듈들을 패키지화 시켜 모아놓은 것이다. **Node Package Modules**의 약자이다. 아이작 슐레터가 만든 노드의 **모듈 패키지 관리 도구**로써, 확장 모듈의 관리를 쉽게 도와준다.

우리는 개발할 때 필요로 하는 일부 기능들을 굳이 직접 개발하지 않아도 누군가가 만들어 올려놓은 모듈을 npm에서 다운받을 수 있다. 이로 인해 개발 난이도는 낮아지고 시간도 단축될 것이다.

이는 Node.js의 인기를 폭발적으로 증가시켜 주었고, 또 이런 인기가 npm을 **세계 최대의 패키지 저장소로 만드는데 큰 기여를 했다.**

현재 Node.js를 설치만 해도 자동으로 npm이 받아진다. 가끔 [npx](https://geonlee.tistory.com/32)나 [yarn](https://cntechsystems.tistory.com/34)이 보이기도 하는데 해당 단어들을 클릭해 알아볼 수 있도록 하자.

npm은 특정 기능 구현을 더 쉽게 만들어 주는 추상화한 API를 제공하기에 노드 개발에 필수적이라 할 수 있다.

### 노드의 확장 모듈과  npm

---

노드의 기본 모듈은 기본적인 API만 제공한다. 기본 모듈로 웬만한 어플리케이션은 개발할 수 있다. 클라이언트 자바스크립트 개발 시 네이티브 자바스크립트말고 jQuery나 프로토타입을 사용하는 것과 유사하다.

하지만 유명한 확장 모듈은 많은 개발자들이 사용해 **검증**되었다는게 중요하다. 이를 통해 프로젝트의 생산성을 극대화 할 수 있다. 허나 이를 사용한 개발한 결과물을 배포할 때는 소스가 의존하는 확장 모듈도 함께 설치되어야 한다. 그래야마나 다른 개발자나 개발환경, 구동 환경이 다른 곳에 설정할 때 어려움이 없다.

이렇게 의존하는 확장 모듈이 업데이트 되면 이에 따른 확장 모듈 관리가 필요하다. 이를 npm이 해결해준다. 자바 개발자라면 메이븐, 그레들. 리눅스 개발자라면 rpm, apt-get, aur을 떠올리면 된다.

`npm [명령어] [타겟 모듈 이름] [옵션]`

`npm install [모듈명]`

npm을 최신 버전으로 설치했다면 이미 설치가 되어있지만, 설치 여부가 궁금하다면 `npm -v`를 통하여 버전을 볼 수있다. 물론 설치가 되어있지 않다면 버전이 출력되지 않는다.

npm을 최신버전으로 업그레이드 하고 싶다면 `npm install -g npm`명령어를 사용하면 된다.

### npm 확장 모듈 설치

---

수많은 확장 모듈을 관리하기 위해 중앙 저장소가 필요하다. npm도 중앙 저장소에서 개발자들이 개발한 확장 모듈들을 관리하고 있다.

초기 설치시 npm은 중앙 저장소에 접근 가능하게 설정되어 있어 따로 설정은 필요 없다. 허나 중앙 저장소가 아닌 개인 용도, 프로젝트 진행을 위해 확장 모듈 저장소를 사용한다면 **별도의 설정이 필요**하다.

우리는 중앙 저장소에 있는 모듈을 설치하기 위해 2가지 방법을 사용한다.

1. 어디서나 사용할 수 있게 **글로벌 설치**
    1. 이는 설치경로/node_modules 디렉토리에 설치된다.
2. 특정 프로젝트만 사용할 수 있게 하는 **로컬 설치**
    1. 현재 개발 중인 애플리케이션의 node_modules 디렉토리에 설치된다.

### 글로벌 설치(전역 설치라고도 한다.)

---

확장 모듈을 설치하면 **{prefix}/lib/node_modules**에 노드 모듈을 설치하고 모듈을 구성하는 파일중 실행과 관련된 파일은 **{prefix}/bin**에 설치한다.

그리고 메뉴얼 페이지는 **{prefix}/share/man**에 설치한다. 여기서 **{prefix}는 기본적으로 /usr/local (리눅스 기준) 이다.**

글로벌로 설치하는 모듈들은 주로 명령줄 도구(CLI)처럼 사용하는 것이다. 명령줄에서 사용하는 모듈은 노드로 작성한 소스와 의존성이 없어, 주로 **개발의 편의성, 지속적인 서비스**를 위한 도구가 이런 형태이다.

이러한 확장 모듈은 **특정 프로젝트만 사용하는게 아니기에 글로벌 설치를 권장한다.**

예를 들면 nodemon이나 express가 있다. 

**반대로 하나의 프로젝트에서만 필요한 모듈은 지역 설치를 권장한다.** 전역 변수, 지역 변수를 언제 어떻게 써야하는지 따라 처럼 node의 확장 모듈 설치도 이를 따라간다.

글로벌 모듈의 설치는 어렵지 않다. 위에서 설명한  install 명령어에 -g를 붙여주면 된다.

그리고 글로벌로 설치된 모듈의 목록을 확인하려면 `npm list -g`를 검색하자.

### 로컬 설치(지역 설치라고도 한다.)

---

확장 모듈을 로컬로 설치하면 현재 디렉토리에 패키지를 설치한다. 확장 모듈을 로컬로 설치하면 현재 디렉토리에 패키지를 설치한다. 노드 모듈은 ./node_modules에, 실행 관련 파일은 ./node_modules/bin 에 설치하며 메뉴얼 페이지를 설치 하지 않는다.

소스 코드에서 require() 메소드를 통해 사용하는 형태로 특정 애플리케이션에서만 사용하는 경우가 많은 확장 모듈은 로컬 설치 형태를 사용하는 것이 좋다.

로컬 설치는 애플리케이션 소스코드가 확장 모듈과 의존성 있게 되므로 애플리케이션과 함께 관리한다. 다시 말해, 로컬 설치는 애플리케이션을 중심으로 해당 애플리케이션이 접근 할 수 있는 로컬에 설치되어야 한다는 의미이다.

-g 없이 설치하면 로컬로 설치되므로 list또한 -g 옵션 없이 입력하면 된다.

**여러 개의 모듈 설치**

`npm install [모듈 1], [모듈 2], [모듈 3]`

**특정 버전의 확장 모듈 설치**

특정 버전을 설치 할때는 @을 붙이고 버전을 명시한다.

`npm install [모듈명@버전]`

### 원하는 npm을 찾아 설치하는 법

---

지금까지 많은 확장 모듈이 존재하고, 지금도 나오고 있을지 모른다. 따라서 어떤 기능을 확장 모듈을 이용해 구현하고 싶다면 수많은 확장 모듈 중 원하는 기능의 확장 모듈이 있는지 확인하고 **그것이 적합한 모듈인지 확인 할 수 있어야 한다.**

npm의 공식 웹사이트엔 npm을 이용한 설치 방법 및 종류들이 나와있따.

**[npmregistry 사이트](https://www.npmjs.com)**

npm registry 사이트에선 중앙 저장소에 등록된 모든 확장 모듈을 검색하고 확인할 수 있따. NPM에 등록된 확장 모듈의 이름과 간단한 소개를 살펴볼 수 있으며, 이를 사용하려면 해당 모듈의 이름으로 npm install 명령을 이용해 설치하면 된다.

npm 검색과 정보확인은 `npm search [모듈명]`이나 `npm lnfo [모듈명]`으로도 가능하다.

### 확장 모듈 관리

---

확장 모듈들은 같은 기능을 구현해도 각자 성능과 구성이 천차만별이다. 하나의 확장 모듈도 지속적으로 개발되는 경우가 대부분이라 **주기적으로 최신 버전으로 업데이트 하거나 필요 없는 모듈은 삭제하여 정리할 필요가 있다.**

- 확장 모듈 목록

    현재 개발 중인 애플리케이션에 설치된 확장 모듈 및 글로벌로 설치된 모듈 확인은 아래와 같다.

    1. `npm list`
    2. `npm list -g`
- 확장 모듈 업데이트

    대부분의 확장 모듈은 오픈 소스로 지속적으로 개발되기 때문에 주기적으로 업데이트 하는 것이 필요하다. 아래 코드를 이용하면 설치된 모듈을 최신 버전으로 업데이트 할 수 있다. 글로벌로 설치된 모듈은 -g 옵션을 붙여서 업데이트한다.

    1. `npm update [모듈명]`
    2. `npm update [모듈명] -g`
    3. `npm update`
        1. 이는 설치된 모든 모듈을 업데이트 하고 싶은 경우에 쓰는 명령어다.
- 확장 모듈 삭제

    uninstall 명령을 이용하면 된다.

    1. `npm uninstall [모듈명]`
    2. `npm uninstall [모듈명] -g`

## package.json

---

노드로 확장 모듈을 작성하면 npm을 통해 중앙 저장소로 배포할 수 있다.

여기서 **package.json 파일은 배포한 모듈 정보를 담고자 만들어졌다.** 또한 **노드로 작성하는 애플리케이션도 package.json 파일을 사용해 관리할 수있다.** 굳이 확장 모듈 형태로 배포하기 위한 것이 아니더라도 **애플리케이션 개발 때 package.json 파일을 이용하면 확장 모듈에 대한 의존성 관리가 가능해 편리하다**.

package.json 파일은 기본적으로 **CommonJS의 명세를 충실히 따르고 있으며 JSON 형식의 파일이다.**

직접 작성이 가능하며 `npm init` 명령을 통해 자동으로 생성할 수도 있다. 그리고 해당 애플리케이션을 위해 사용한 확장 모듈에 대한 정보는 `npm list -save`를 통하여 자동으로 모듈에 대한 정보를 추가할 수 있다.

아래 package.json 파일의 내용과 설명이다. **기본적으로 프로젝트에 대한 명세**라고 할 수 있다. 아래 내용들은 모두 구름 EDU에서 가져왔다.

    {
    	"name" : "test",
    	"description" : "javascript's test programming.",
    	"keywords" : ["util", "f", "server", "client", "browser"],
    	"author" : "Goorm",
    	"contributors" : [],
    	"dependencies" : [],
    	"repository" : {"type": "git", "url" : "git://gitbub.com/documentcloud/test.git" },
    	"main" : "test.js",
    	"version" : "1.1.6"
    }

- name : 프로젝트의 이름으로, 가장 중요하다. 중앙 저장소에 배포할 때에 version과 함께 필수 항목이다.
url로 사용되고, 설치할 때 디렉토리의 이름이 되기에 **url이나 디렉터리에 쓸수 없는 이름을 사용하면 안된다. 또한 이름에 node나 js가 들어가면 안되며 214자 이내여야 하고, 점(.)이나 언더바(_)로 시작할 수 없다. 대문자는 포함할 수 없으며 require()함수의 신수로 사용되기에 짧고 알기 쉬운 것으로 짓는게 좋다.**
(중요하니 만큼 요구사항도 많다.)
- version : 프로젝트의 버전을 정의한다. 3단계 버전을 사용하며, - 로 태그 이름을 적을 수도 있따.
- description : 프로젝트의 설명으로, 문자열로 기술한다. npm search로 검색된 리스트에 표시되기에 사람들이 패키지를 찾아 내고 이해하는데 도움이 된다.
- keywords : 프로젝트를 검색할 때 참조되는 키워드이다.
- homepage : 프로젝트의 홈페이지 주소이다.
- author : 프로젝트의 작성자 정보로, 한 사람만을 지정한다. JSON 형식으로 name, email, url 옵션을 포함할 수 있다.
- contributors : 프로젝트에 참여한 공헌자 정보로, 여러 사람을 배열로 지정할 수 있다.
- repository : 프로젝트의 소스 코드를 저장한 저장소의 정보이다. 소스 코드에 참여하고자 하는 사람들에게 도움이 될 수 있다. **프로젝트의 홈페이지 url을 명시해선 안된다.**
- scripts : 프로젝트에서 자주 실행해야 하는 명령어를 scripts로 작성해 두면 npm 명령어로 실행 가능하다.
- config : 소스 코드에서 config 필드에 있는 값을 환경 변수처럼 사용가능 하다.
- private : 이 값을 true로 하면 중앙 저장소로 저장되지 않는다.
- dependencies : **프로젝트 의존성 관리를 위한 부분이다. 이 프로젝트가 어떤 확장 모듈을 요구하는지 정리할 수 있다.**
일반적으로 package.json에서 가장 많은 정보가 입력되는 곳으로 애플리케이션을 설치할 때 이 내용을 참조해 필요한 확장 모듈을 자동으로 설치한다.
따라서 개발한 애플리케이션이 특정한 확장 모듈을 사용한다면 여기에 꼭 명시 해주어야 한다.
또한, npm install 명령은 여기에 포함된 모든 확장 모듈들을 설치하게 되어 있다.
- devDependencies : 개발 할 때만 의존하는 확장 모듈을 관리한다.
- engine : 실행 가능한 노드 버전의 범위를 결정한다.

# nodemon

---

이제 다음부턴 express 등 확장 모듈과 이를 활용한 프로젝트를 만들 것이다. 그 전에 앞으로 개발을 할 때 좀더 편리하게 해주는 확장 모듈을 소개한다.

바로 **nodemon**이다.

<center><img src="/assets/img/nodejs/2020-03-03-Node.js-공부(7)/2.png"></center>

nodemon은 `node monitor`의 약자로 노드가 실행하는 파일이 속한 디렉터리를 감시하다 파일이 수정되면 자동으로 노드 어플리케이션을 재시작하는 확장 모듈이다.

이를 이용하면 개발 중인 노드 애플리케이션 소스 코드를 수정할 때마다 매번 노드 명령어를 통해 새로 시작할 필요가 없어 매우 편리하다.

설치는 `npm install nodemon -g`를 통해 할 수 있다. 사용 방법 또한 간단한데 실행하고자 하는 애플리케이션을 node 명령어 대신 nodemon으로 실행하면 된다. 이는 node 프로젝트를 더 편리하게 쓰기 위함이므로 이를 권장한다.